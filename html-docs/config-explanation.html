<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Qudi: How to use and understand a config file</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Qudi
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">How to use and understand a config file </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Config files are essential in our software, since they tell basically which modules you want to connect to each other. The config file is also the place where the required parameters are specified individually for a module.</p>
<h2>YAML implementation in Qudi</h2>
<p>Our config file uses the <a href="http://yaml.org/">YAML</a> format, a data serialization format designed for human readability and interaction with scripting languages. Qudi modifies the ruamel.yaml implementation, which serves as a YAML parser. Therefore Qudi has implemented a loader and a dumper using an collections.OrderedDict() instead of the regular python dict() used by ruamel.yaml. Additionally, it fixes a bug in ruamel.yaml with scientific notation and allows to dump numpy.dtypes and numpy.ndarrays.</p>
<h2>Example of a config file</h2>
<p>Each module is defined in a predetermined category i.e. in</p>
<ul>
<li>global,</li>
<li>hardware,</li>
<li>logic or</li>
<li>gui.</li>
</ul>
<p>These categories (all except global) are folders in the trunk directory of our software.</p>
<p>Let's have a look on an example scenario of an (incomplete) configuration: </p><div class="fragment"><div class="line">hardware:</div><div class="line">    &lt;identifier&gt;:</div><div class="line">        module.Class: &#39;&lt;foldername&gt;.&lt;filename&gt;.&lt;classname&gt;&#39;</div><div class="line">        attribute_string_example:   &#39;example_text&#39;</div><div class="line">        attribute_int_example:      12345</div><div class="line">        attribute_float_example:    1.234</div><div class="line">        attribute_boolean_example:  True</div><div class="line">        attribute_list_example:</div><div class="line">                                - &#39;first&#39;</div><div class="line">                                - &#39;second&#39;</div><div class="line">                                - &#39;another&#39;</div><div class="line">        attribute_list_floats:</div><div class="line">                                - -200.0    # the second minus belongs to the number</div><div class="line">                                - 0.0</div><div class="line">                                - 200.0</div><div class="line"></div><div class="line"></div><div class="line">logic:</div><div class="line">    &lt;identifier-other&gt;:</div><div class="line">        module.Class: &#39;&lt;foldername2&gt;.&lt;filename2&gt;.&lt;classname2&gt;&#39;</div><div class="line">        attribute1: &#39;assigned_value1&#39;</div><div class="line">        connect:</div><div class="line">            &lt;keyword_in1&gt;: &#39;&lt;identifier&gt;.&lt;keyword_out1&gt;&#39;</div><div class="line"></div><div class="line">gui:</div><div class="line">    &lt;identifier-other2&gt;:</div><div class="line">        module.Class: &#39;&lt;foldername3&gt;.&lt;filename3&gt;.&lt;classname3&gt;&#39;</div><div class="line">        attribute1: &#39;assigned_value1&#39;</div><div class="line">        connect:</div><div class="line">            &lt;keyword_in2&gt;: &#39;&lt;identifier-other&gt;.&lt;keyword_out2&gt;&#39;</div></div><!-- fragment --><p>Each of this categories contains an <code>&lt;identifier&gt;</code>, i.e. a name which is used for a module. This identifier is relevant in order to separate and distinguish between the different modules. The <code>&lt;identifier&gt;</code> represents a reference to the constructed object of the module. Therefore the keyword <code>module.Class</code> indicates the path to the construction class in pythonic notation (directory separated by points).</p>
<p>For instance: In the category <code>hardware</code> you can specify the attribute <code>module.Class</code> in the <code>&lt;identifier&gt;</code> as</p>
<div class="fragment"><div class="line">module.Class: &#39;ni_card.NICard&#39;</div></div><!-- fragment --><p>which will determine that the module will be found in the trunk folder in the folder structure: </p><pre class="fragment">\trunk\hardware\ni_card.py
</pre><p>where the class <code>NICard</code> should be situated within the file <code>ni_card.py</code>.</p>
<p>Within the construction class, connectors ( <code>_in</code> and <code>_out</code>) must be declared. These connectors will allow other modules to attach to it (via the <code>_in</code> connectors) and/or allow the specific module to be connected to something else (via the <code>_out</code> connectors).</p>
<p>Therefore, gui modules have by definition <b>only <code>_in</code> connectors</b>, since different logic outputs (<code>_out</code> connectors) can be 'plugged' into the gui. Due to the same idea, hardware modules can <b>only have <code>_out</code> connectors</b>, which have to be 'plugged' into logic modules. As a result, the logic modules can have both, <code>_in</code> or <code>_out</code> connectors.</p>
<p>The connector is defined as follows: Within a class, the connector is saved in a dictionary type, e.g.</p>
<div class="fragment"><div class="line">class &lt;classname2&gt;(...):</div><div class="line">...</div><div class="line">    _in  = {&#39;&lt;keyword_in1&gt;&#39; : &#39;&lt;itemname1&gt;&#39;}</div><div class="line">    _out = {&#39;&lt;keyword_out2&gt;&#39;: &#39;&lt;itemname2&gt;&#39;}</div></div><!-- fragment --><p>meaning that it has a <code>&lt;keyword&gt;</code> and an <code>&lt;item&gt;</code>. Only the <code>&lt;keywords&gt;</code> for the <code>_in</code> connector will appear in the <code>connect</code> attribute of the <code>&lt;identifier-other&gt;</code> module. (See above in the configuration example). To this <code>_in</code> connectors you can plug in other modules, which are represented by an <code>&lt;identifier-other&gt;</code>. After the <code>&lt;identifier-other&gt;</code> the keyword <code>&lt;keyword-out3&gt;</code> from the module with the <code>_out</code> connector, has to follow.</p>
<p>Note that <code>&lt;keyword_out3&gt;</code> has to be declared as <code>_out</code> connector in the class <code>&lt;classname&gt;</code> like:</p>
<div class="fragment"><div class="line">class &lt;classname&gt;(...):</div><div class="line">    ...</div><div class="line">    _out = { &#39;&lt;keyword_out1&gt;&#39; : &#39;&lt;itemname3&gt;&#39;}</div></div><!-- fragment --><p>Consequently the class <code>&lt;classname2&gt;</code> has to have the <code>_in</code> connector definition like stated above.</p>
<p>The names <code>&lt;itemname&gt;</code>, <code>&lt;itemname2&gt;</code> and <code>&lt;itemname3&gt;</code> can be chosen freely, but for consistency reasons, we have chosen the following definition:</p>
<ul>
<li><code>_out</code> connectors of the hardware classes should have the name of the interfaces through which you can access that hardware object as their itemnames, e.g. for a microwave source this would be <code>'MicrowaveInterface'</code>.</li>
<li>Consequently, the itemnames of <code>_in</code> connectors in the logic files should also have interface names.</li>
<li>The itemnames of the <code>_out</code> connectors in the Logic should be called after the present logic classname.</li>
<li>The itemnames of the <code>_in</code> connector in the GUI should be called after the logic class, which should be attached to it. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
